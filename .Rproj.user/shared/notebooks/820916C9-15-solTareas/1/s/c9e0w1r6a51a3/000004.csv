"0","str(Smarket) # 1250 registros"
"1","'data.frame':	"
"1","1250"
"1"," obs. of  "
"1","9"
"1"," variable"
"1","s"
"1",":"
"1","
"
"1"," "
"1","$ "
"1","Year     "
"1",":"
"1"," num  "
"1","2001 2001 2001 2001 2001"
"1"," ..."
"1","
"
"1"," "
"1","$ "
"1","Lag1     "
"1",":"
"1"," num  "
"1","0.381 0.959 1.032 -0.623 0.614"
"1"," ..."
"1","
"
"1"," "
"1","$ "
"1","Lag2     "
"1",":"
"1"," num  "
"1","-0.192 0.381 0.959 1.032 -0.623"
"1"," ..."
"1","
"
"1"," "
"1","$ "
"1","Lag3     "
"1",":"
"1"," num  "
"1","-2.624 -0.192 0.381 0.959 1.032"
"1"," ..."
"1","
"
"1"," "
"1","$ "
"1","Lag4     "
"1",":"
"1"," num  "
"1","-1.055 -2.624 -0.192 0.381 0.959"
"1"," ..."
"1","
"
"1"," "
"1","$ "
"1","Lag5     "
"1",":"
"1"," num  "
"1","5.01 -1.055 -2.624 -0.192 0.381"
"1"," ..."
"1","
"
"1"," "
"1","$ "
"1","Volume   "
"1",":"
"1"," num  "
"1","1.19 1.3 1.41 1.28 1.21"
"1"," ..."
"1","
"
"1"," "
"1","$ "
"1","Today    "
"1",":"
"1"," num  "
"1","0.959 1.032 -0.623 0.614 0.213"
"1"," ..."
"1","
"
"1"," "
"1","$ "
"1","Direction"
"1",":"
"1"," Factor w/ 2 levels ""Down"",""Up"": "
"1","2 2 1 2 2 2 1 2 2 2"
"1"," ..."
"1","
"
"0","set.seed(123)"
"0","d = sort(sample(nrow(Smarket),nrow(Smarket)*0.66, replace=FALSE))"
"0","# dividir en una conjunto de  training y test set"
"0","train_data <- Smarket[d, ]"
"0","test_data  <- Smarket[-d, ] "
"0","modelo.logit <- glm(Direction ~ Lag1 + Lag2 + Lag3, family = binomial(""logit""), data =train_data)"
"0","summary(modelo.logit)"
"1","
Call:
"
"1","glm(formula = Direction ~ Lag1 + Lag2 + Lag3, family = binomial(""logit""), 
    data = train_data)"
"1","

"
"1","Deviance Residuals: 
"
"1","   Min  "
"1","    1Q  "
"1","Median  "
"1","    3Q  "
"1","   Max  "
"1","
"
"1","-1.463  "
"1","-1.203  "
"1"," 1.039  "
"1"," 1.140  "
"1"," 1.465  "
"1","
"
"1","
Coefficients:
"
"1","           "
"1"," Estimate"
"1"," Std. Error"
"1"," z value"
"1"," Pr(>|z|)"
"1","  "
"1","
(Intercept)"
"1","  0.08448"
"1","    0.06997"
"1","   1.207"
"1","   0.2273"
"1","  "
"1","
Lag1       "
"1"," -0.12569"
"1","    0.06256"
"1","  -2.009"
"1","   0.0445"
"1"," *"
"1","
Lag2       "
"1"," -0.02529"
"1","    0.05985"
"1","  -0.423"
"1","   0.6726"
"1","  "
"1","
Lag3       "
"1","  0.02817"
"1","    0.06108"
"1","   0.461"
"1","   0.6447"
"1","  "
"1","
"
"1","---
Signif. codes:  "
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
(Dispersion parameter for "
"1","binomial"
"1"," family taken to be "
"1","1"
"1",")

"
"1","    Null deviance: 1142.4  on 824  degrees of freedom
"
"1","Residual deviance: 1137.9  on 821  degrees of freedom
"
"1","AIC: "
"1","1145.9"
"1","

"
"1","Number of Fisher Scoring iterations: "
"1","3"
"1","
"
"1","
"
"0","# probabilidades:"
"0","probs <- predict(modelo.logit, test_data, type = ""response"")"
"0","head(probs)"
"1","        3 "
"1","        5 "
"1","        6 "
"1","       10 "
"1","       11 "
"1","       14 "
"1","
"
"1","0.4853155 "
"1","0.5130299 "
"1","0.5061573 "
"1","0.4771843 "
"1","0.5040527 "
"1","0.4974412 "
"1","
"
"0","prediccion <- ifelse(probs > 0.5, 1, 0)"
"0","table(prediccion, test_data$Direction)"
"1","          
"
"1","prediccion"
"1"," Down"
"1","  Up"
"1","
         0"
"1","   46"
"1","  53"
"1","
         1"
"1","  160"
"1"," 166"
"1","
"
"0","mean(prediccion) # [1] 0.7670588"
"1","[1]"
"1"," 0.7670588"
"1","
"
